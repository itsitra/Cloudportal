<div class="animated fadeIn">
  <ng-template #SampleDescription class="modal modal-xl">
    <div class="model-content">
      <div class="modal-header">
        <h4 class="modal-title pull-left">Update Sample Description</h4>
        <button
          style="outline: none; border: none"
          type="button"
          class="close pull-right text-white"
          aria-label="Close"
          (click)="modalRef.hide()"
        >
          <i class="fa fa-times" aria-hidden="true"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <table class="table table-bordered mx-2">
            <thead>
              <tr>
                <th scope="col" style="width: 15%">Sample No.</th>
                <th scope="col" style="width: 20%">Sample Type</th>
                <th scope="col" style="width: 15%">Count</th>
                <th scope="col" style="width: 25%">Description</th>
                <th scope="col" style="width: 25%">Remarks</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let usd of UpdateSampleDesc">
                <th scope="row">
                  <input
                    type="text"
                    [value]="usd.sampleno"
                    readonly
                    class="form-control bg-white"
                    style="
                      outline: none;
                      border: none;
                      font-weight: bold;
                      color: black;
                    "
                  />
                  <!-- {{sd.sampleno}} -->
                </th>
                <td>
                  <select class="form-control" [(ngModel)]="usd.sampleid">
                    <option value="0">-SELECT-</option>
                    <option
                      *ngFor="let std of sampleTypeData"
                      [value]="std.sampleid"
                    >
                      {{ std.samplename }}
                    </option>
                  </select>
                </td>
                <td>
                  <input
                    type="text"
                    class="form-control"
                    [(ngModel)]="usd.countcode"
                  />
                </td>
                <td>
                  <input
                    type="text"
                    class="form-control"
                    [(ngModel)]="usd.description"
                  />
                </td>
                <td>
                  <input
                    type="text"
                    class="form-control"
                    [(ngModel)]="usd.remarks"
                  />
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- <div class="row" *ngFor="let sd of sampleData">
          <div class="col-md-2">
            <div class="form-group">
              <label for="">Sample No.</label>
              <input type="text" class="form-control">
            </div>
          </div>
          <div class="col-md-2">
            <div class="form-group">
              <label for="name">
                <font color="red">*</font>Sample Type
              </label>
              <select class="form-control">
                <option value="">-SELECT-</option>
                <option value="">1</option>
                <option value="">2</option>
                <option value="">3</option>

              </select>
            </div>
          </div>

          <div class="col-md-2">
            <div class="form-group ">
              <label for="ccmonth">Count</label>
              <input type="text" class="form-control">
            </div>
          </div>

          <div class="col-md-3">
            <div class="form-group ">
              <label for="ccmonth">
                <font color="red">*</font>Description
              </label>
              <input type="text" class="form-control">
            </div>
          </div>

          <div class="col-md-3">
            <div class="form-group ">
              <label for="ccmonth">Remarks</label>
              <input type="text" class="form-control">
            </div>
          </div>
        </div> -->
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          (click)="modalRef.hide()"
        >
          Close
        </button>
        <button
          type="button"
          class="btn btn-success"
          (click)="Updatesampledescription()"
        >
          Confirm
        </button>
      </div>
    </div>
  </ng-template>

  <ng-template #paymentType class="modal">
    <div class="model-content">
      <div class="modal-header">
        <h4 class="modal-title pull-left">Select payment Type</h4>
        <button
          style="outline: none; border: none"
          type="button"
          class="close pull-right text-white"
          aria-label="Close"
          (click)="modalRef.hide()"
        >
          <i class="fa fa-times" aria-hidden="true"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="row px-5">
          <div class="form-group">
            <label for="totalAmount">Total Amount: </label>
            <span style="font-weight: bold">&nbsp;{{ Amount }}</span>
          </div>
        </div>
        <div class="row px-5 py-3">
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="paymentMode"
              [value]="1"
              id="rdoCCcard"
              [(ngModel)]="paymentMode"
            />
            <label class="form-check-label" for="rdoCCcard">
              Credit Card
            </label>
            <div *ngIf="bankCharges.credit_card !== '0'">
              <small class="text-danger"
                >({{ bankCharges.credit_card }}% of tax will be charaged on
                total amount)</small
              >
            </div>
          </div>
        </div>
        <div class="row px-5 py-3">
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="paymentMode"
              [value]="2"
              id="rdoDRcard"
              [(ngModel)]="paymentMode"
            />
            <label class="form-check-label" for="rdoDRcard">
              Debit Rupay
            </label>
            <div *ngIf="bankCharges.debit_rupay !== '0'">
              <small class="text-danger"
                >({{ bankCharges.debit_rupay }}% of tax will be charaged on
                total amount)</small
              >
            </div>
          </div>
        </div>
        <div class="row px-5 py-3">
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="paymentMode"
              [value]="3"
              id="rdoDLTcard"
              [(ngModel)]="paymentMode"
            />
            <label class="form-check-label" for="rdoDLTcard">
              Debit lt 2000
            </label>
            <div *ngIf="bankCharges.debit_lt_2000 !== '0'">
              <small class="text-danger"
                >({{ bankCharges.debit_lt_2000 }}% of tax will be charaged on
                total amount)</small
              >
            </div>
          </div>
        </div>
        <div class="row px-5 py-3">
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="paymentMode"
              [value]="4"
              id="rdoDGTcard"
              [(ngModel)]="paymentMode"
            />
            <label class="form-check-label" for="rdoDGTcard">
              Debit gt 2000
            </label>
            <div *ngIf="bankCharges.debit_gt_2000 !== '0'">
              <small class="text-danger"
                >({{ bankCharges.debit_gt_2000 }}% of tax will be charaged on
                total amount)</small
              >
            </div>
          </div>
        </div>
        <div class="row px-5 py-3">
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="paymentMode"
              [value]="5"
              id="rdoUPI"
              [(ngModel)]="paymentMode"
            />
            <label class="form-check-label" for="rdoUPI"> UPI </label>
            <div *ngIf="bankCharges.upi !== '0'">
              <small class="text-danger"
                >({{ bankCharges.upi }}% of tax will be charaged on total
                amount)</small
              >
            </div>
          </div>
        </div>
        <div class="row px-5 py-3">
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="paymentMode"
              [value]="6"
              id="rdoNetBanking"
              [(ngModel)]="paymentMode"
            />
            <label class="form-check-label" for="rdoNetBanking">
              NetBanking
            </label>
            <div *ngIf="bankCharges.nb !== '0'">
              <small class="text-danger"
                >({{ bankCharges.nb }}% of tax will be charaged on total
                amount)</small
              >
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          (click)="modalRef.hide()"
        >
          Close
        </button>
        <button
          type="button"
          class="btn btn-success"
          (click)="paymentTypeSelection(Amount, quatatioNO)"
        >
          Proceed To Pay
        </button>
      </div>
    </div>
  </ng-template>
  <ng-template #testname class="modal">
    <div class="model-content">
      <div class="modal-header">
        <h4 class="modal-title pull-left">Your Quotation tests</h4>
        <button
          style="outline: none; border: none"
          type="button"
          class="close pull-right text-white"
          aria-label="Close"
          (click)="modalRef.hide()"
        >
          <i class="fa fa-times" aria-hidden="true"></i>
        </button>
      </div>
      <div class="modal-body">
        <div>
          <table
            style="width: 100%"
            class="table table-responsive-sm table-hover table-outline mb-0"
          >
            <thead class="thead-light">
              <th>Test Name</th>
              <th>Test Qty</th>
              <th>Test Rate</th>
            </thead>
            <tbody>
              <tr *ngFor="let t of ProformaTestName">
                <td>
                  <span [innerHTML]="t.testname"></span>
                </td>
                <td>
                  {{ t.qty }}
                </td>
                <td>
                  {{ t.rate }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          (click)="modalRef.hide()"
        >
          Close
        </button>
      </div>
    </div>
  </ng-template>
  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-header">Proforma List</div>
        <div class="card-body">
          <div class="row d-flex justify-content-end">
            <div class="col-md-4">
              <div class="input-group">
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="proformaSearchText"
                  id="frequent-test-search"
                  placeholder="Search..."
                />
                <div class="input-group-prepend">
                  <button
                    (click)="getProformaList()"
                    class="btn btn-primary rounded-right"
                  >
                    <i class="fa fa-search" aria-hidden="true"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <br />
          <table
            style="width: 100%"
            class="table table-responsive-sm table-hover table-outline mb-0"
          >
            <thead class="thead-light">
              <tr>
                <th style="width: 10%">Quotation No.</th>
                <th style="width: 10%">Request Number</th>

                <th style="width: 15%">Date</th>
                <th style="width: 15%">Lab Name</th>
                <th style="width: 20%">Sample Description</th>
                <th style="width: 10%">Test Name</th>
                <th style="width: 10%">Net Amount</th>
                <th style="width: 10%">Payment Status</th>

                <th style="width: 20%">
                  <!-- <button type="button" class="btn btn-primary"
                    tooltip="Pay Now">
                    <i class="fa fa-credit-card" aria-hidden="true"></i>
                  </button>
                  <button type="button" class="btn btn-warning"
                    tooltip="Genrate Request">
                    <i class="fa fa-file-text-o" aria-hidden="true"></i>
                  </button>
                  <button type="button" class="btn btn-danger"
                    tooltip="Update Sample Description">
                   <i class="fa fa-pencil-square" aria-hidden="true"></i>
                    </button> -->
                  Action
                </th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let pl of PaginatedList">
                <td>{{ pl.quotationno }}</td>

                <td>{{ pl.reqno }}</td>

                <td>{{ this.datapipe.transform(pl.date, "dd/MM/yyyy") }}</td>
                <td>{{ pl.lab_name }}</td>
                <td>{{ pl.sampdesc }}</td>
                <td>
                  <button
                    type="button"
                    class="btn btn-warning"
                    tooltip="Test Details"
                    (click)="testnameOpen(testname, pl.quotationno)"
                  >
                    <i class="fa fa-eye" aria-hidden="true"></i>
                  </button>
                </td>
                <td>{{ pl.netamt }}</td>
                <td>
                  {{
                    pl.paymentstatus == "captured"
                      ? "Sucess"
                      : "Not yet done Payment or Failure "
                  }}
                </td>

                <td>
                  <!-- <button type="button" class="btn btn-primary" tooltip="Pay Now" (click)="proformaPayNow(pl.netamt)"> -->
                  <button
                    type="button"
                    class="btn btn-primary"
                    tooltip="Pay Now"
                    [disabled]="pl.paymentstatus === 'captured'"
                    (click)="
                      paymentOptionOpen(paymentType, pl.netamt, pl.quotationno)
                    "
                  >
                    <i class="fa fa-credit-card" aria-hidden="true"></i></button
                  >&nbsp;
                  <button
                    type="button"
                    class="btn btn-warning"
                    tooltip="Generate Testing Request"
                    [disabled]="pl.RequestGenerated === 'Y'"
                    (click)="genrateRequest(pl.quotationno)"
                  >
                    <i class="fa fa-file-text-o" aria-hidden="true"></i></button
                  >&nbsp;
                  <!-- <button
                    type="button"
                    class="btn btn-danger"
                    tooltip="Update Sample Description"
                    (click)="
                      getSampleData(SampleDescription, pl.quotationno, pl.labid)
                    "
                  >
                    <i class="fa fa-pencil-square" aria-hidden="true"></i>
                  </button> -->
                </td>
              </tr>
            </tbody>
          </table>
          <hr />
          <div class="row d-flex justify-content-between">
            <div class="col-md-1">
              <select
                class="form-control"
                name=""
                id=""
                [(ngModel)]="proformaitemperpage"
                (ngModelChange)="itemChange()"
              >
                <option value="5">5</option>
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="50">50</option>
              </select>
            </div>
            <div class="col-md-5">
              <pagination
                style="float: right"
                [itemsPerPage]="itemperpage"
                [totalItems]="ProformaList.length"
                (pageChanged)="ProformaPageChanged($event)"
              ></pagination>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--/.col-->
  </div>
  <!--/ End Table-->
</div>
